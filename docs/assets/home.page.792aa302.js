var x=Object.defineProperty,m=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var ss=Object.prototype.hasOwnProperty,os=Object.prototype.propertyIsEnumerable;var L=(c,a,d)=>a in c?x(c,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):c[a]=d,U=(c,a)=>{for(var d in a||(a={}))ss.call(a,d)&&L(c,d,a[d]);if(E)for(var d of E(a))os.call(a,d)&&L(c,d,a[d]);return c},X=(c,a)=>m(c,I(a));import{d as es,g as C,h as j,o as l,c as t,i as s,F as k,j as S,u as B,p as ls,k as ts,t as h,n as M,l as O,w as g,m as w,q as as}from"./vendor.10c8995a.js";import{s as y,r as ns}from"./index.cc6ae806.js";import{_ as is}from"./plugin-vue_export-helper.21dcd24c.js";const N=c=>(ls("data-v-75301b4a"),c=c(),ts(),c),cs=N(()=>s("div",{class:"header"},[s("h1",null,"BOX-R")],-1)),ds={class:"main"},rs={class:"category-list"},us={class:"category-head"},_s=["src","alt"],vs={class:"template-list"},hs=["onClick"],fs={class:"info"},ps={class:"thumbnail"},ks=["src","alt"],gs={class:"content"},ys=as("Size: "),bs={class:"price"},Cs={key:0},Ss=N(()=>s("em",null,"\u20AB",-1)),Os={key:0,class:"detail"},ws={class:"links"},Ns={key:0,class:"start-from-scratch"},$s={class:"selectors"},Ds={class:"material-selection"},Ts=N(()=>s("h5",null,"Select material",-1)),js={class:"material-list"},Bs=["onClick"],Ms={class:"thumbnail"},zs={class:"content"},Rs={key:0,class:"price"},Fs={class:"color-selection"},Js=N(()=>s("h5",null,"Select color",-1)),Vs={key:0,class:"material-name"},As={class:"color-list"},qs=["onClick"],Es={key:1,class:"no-color"},Ls={class:"actions"},Us={key:1,class:"choose-a-design"},Xs=N(()=>s("p",null,"TODO: ...",-1)),Gs=[Xs],Hs=es({setup(c){const a=C("blank"),d=C(null),f=C(null),u=C(null),n=C(null),G=j(()=>y.state.categories),z=j(()=>y.state.materialRecord),H=j(()=>y.state.templateRecord);function K(_){ns.push({name:"editor",params:{iid:`${_.slug}-${_.id}`}})}function P(){var r;if(!d.value||!f.value||!u.value||!((r=n.value)==null?void 0:r.front))return;const _=f.value.spec.units.reduce(($,i)=>($[i.id]={front:{showBackdrop:!0,showNumbering:!0,color:n.value.front,canvasJSON:JSON.stringify({version:"4.6.0",objects:[]})},back:{showBackdrop:!0,showNumbering:!0,color:n.value.back||n.value.front,canvasJSON:JSON.stringify({version:"4.6.0",objects:[]})}},$),{}),e={id:Math.floor(Math.random()*1e3),slug:"untitled-design",title:"Untitled design",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),template_id:f.value.id,category_id:d.value.id,material_id:u.value.id,design_data:_};y.dispatch("createDesign",e).then(()=>K(e))}async function Q(_,e){d.value=_,f.value=e,await y.dispatch("loadMaterials",e),R(z.value[e.id].find(r=>r.id===e.default_material_id))}function R(_){n.value=null,u.value=_,n.value=Object.keys(u.value.textures).reduce((e,r)=>(e[r]=u.value.textures[r].colors[0],e),{})}function W(_,e){n.value=X(U({},n.value),{[_]:e})}function Y(){alert("TODO: choose custom color ...")}return y.dispatch("loadCategoriesAndTemplates"),(_,e)=>(l(),t(k,null,[cs,s("div",ds,[s("ul",rs,[(l(!0),t(k,null,S(B(G),(r,$)=>(l(),t("li",{key:$},[s("h2",us,[s("img",{src:r.thumbnail,alt:r.title},null,8,_s),s("strong",null,h(r.title),1)]),s("ul",vs,[(l(!0),t(k,null,S(B(H)[r.id],(i,Z)=>{var F,J;return l(),t("li",{key:Z,onClick:o=>{var v;return i.id===((v=f.value)==null?void 0:v.id)?!1:Q(r,i)},class:M({active:i.id===((F=f.value)==null?void 0:F.id)})},[s("div",fs,[s("div",ps,[s("img",{src:i.thumbnail,alt:i.title},null,8,ks)]),s("div",gs,[s("h3",null,h(i.title),1),s("p",null,[ys,s("strong",null,h(i.display_size),1)])]),s("div",bs,[i.sale_off?(l(),t("span",Cs,"-"+h(i.sale_off)+" off",1)):O("",!0),s("strong",null,h(i.base_price-i.sale_off),1),Ss])]),i.id===((J=f.value)==null?void 0:J.id)?(l(),t("div",Os,[s("div",ws,[s("h4",{onClick:e[0]||(e[0]=g(o=>a.value="blank",["prevent"])),style:w({opacity:a.value==="blank"?1:.5})},"Start from scratch",4),s("h4",{onClick:e[1]||(e[1]=g(o=>a.value="ready",["prevent"])),style:w({opacity:a.value==="ready"?1:.5})},"Choose a design",4)]),a.value==="blank"?(l(),t("div",Ns,[s("div",$s,[s("div",Ds,[Ts,s("ul",js,[(l(!0),t(k,null,S(B(z)[i.id],(o,v)=>{var p,D,b,T,V,A,q;return l(),t("li",{key:v,class:M({active:((p=u.value)==null?void 0:p.id)===o.id}),onClick:g(Ks=>R(o),["stop"])},[s("div",Ms,[s("em",{class:"color-front",style:w({background:((D=u.value)==null?void 0:D.id)===o.id&&((b=n.value)==null?void 0:b.front)?n.value.front:o.textures.front.colors[0]})},null,4),s("em",{class:"color-back",style:w({background:((T=u.value)==null?void 0:T.id)===o.id&&(((V=n.value)==null?void 0:V.back)||((A=n.value)==null?void 0:A.front))?n.value.back||n.value.front:((q=o.textures.back)==null?void 0:q.colors[0])||o.textures.front.colors[0]})},null,4)]),s("div",zs,[s("h6",null,h(o.title),1)]),o.offset_price?(l(),t("div",Rs,"+"+h(o.offset_price),1)):O("",!0)],10,Bs)}),128))])]),s("div",Fs,[Js,u.value&&u.value.textures.front.colors.length>1?(l(!0),t(k,{key:0},S(u.value.textures,(o,v)=>(l(),t("div",{key:v},[(o==null?void 0:o.title)?(l(),t("div",Vs,h(o.title),1)):O("",!0),s("ul",As,[(l(!0),t(k,null,S(o==null?void 0:o.colors,(p,D)=>{var b;return l(),t("li",{key:D,class:M({active:((b=n.value)==null?void 0:b[v])===p}),onClick:g(T=>W(v,p),["stop"])},[s("h6",{class:"thumbnail",style:w({background:p})},null,4)],10,qs)}),128)),(o==null?void 0:o.customizable)?(l(),t("li",{key:0,class:"choose-custom",onClick:e[2]||(e[2]=g(p=>Y(),["stop"]))},"(+)")):O("",!0)])]))),128)):(l(),t("p",Es,"This material doesn't support custom background color!"))])]),s("div",Ls,[s("button",{onClick:e[3]||(e[3]=g(o=>P(),["stop"]))},"Start design")])])):(l(),t("div",Us,Gs))])):O("",!0)],10,hs)}),128))])]))),128))])])],64))}});var Zs=is(Hs,[["__scopeId","data-v-75301b4a"]]);export{Zs as default};
