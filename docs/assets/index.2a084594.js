var v=Object.defineProperty;var m=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var l=(e,t,r)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))w.call(t,r)&&l(e,r,t[r]);if(m)for(var r of m(t))L.call(t,r)&&l(e,r,t[r]);return e};var f=(e,t,r)=>(l(e,typeof t!="symbol"?t+"":t,r),r);import{d as D,r as E,u as R,o as p,c as h,a as S,b as W,e as P,S as G,f as $}from"./vendor.51d93dd3.js";const x=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerpolicy&&(i.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?i.credentials="include":n.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}};x();class I{static isWebGLAvailable(){try{const t=document.createElement("canvas");return!!(window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl")))}catch{return!1}}static isWebGL2Available(){try{const t=document.createElement("canvas");return!!(window.WebGL2RenderingContext&&t.getContext("webgl2"))}catch{return!1}}static getWebGLErrorMessage(){return this.getErrorMessage(1)}static getWebGL2ErrorMessage(){return this.getErrorMessage(2)}static getErrorMessage(t){const r={1:"WebGL",2:"WebGL 2"},o={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext};let n='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>';const i=document.createElement("div");return i.id="webglmessage",i.style.fontFamily="monospace",i.style.fontSize="13px",i.style.fontWeight="normal",i.style.textAlign="center",i.style.background="#fff",i.style.color="#000",i.style.padding="1.5em",i.style.width="400px",i.style.margin="5em auto 0",o[t]?n=n.replace("$0","graphics card"):n=n.replace("$0","browser"),n=n.replace("$1",r[t]),i.innerHTML=n,i}}const A={key:0,class:"webgl-unavailable"},C={key:1,class:"page-container"},k=D({setup(e){const t=I.isWebGLAvailable();return(r,o)=>{const n=E("router-view");return R(t)?(p(),h("div",C,[S(n)])):(p(),h("div",A,"No WebGL available!"))}}}),O="modulepreload",y={},M="/",_=function(t,r){return!r||r.length===0?t():Promise.all(r.map(o=>{if(o=`${M}${o}`,o in y)return;y[o]=!0;const n=o.endsWith(".css"),i=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${i}`))return;const s=document.createElement("link");if(s.rel=n?"stylesheet":O,n||(s.as="script",s.crossOrigin=""),s.href=o,document.head.appendChild(s),n)return new Promise((c,a)=>{s.addEventListener("load",c),s.addEventListener("error",a)})})).then(()=>t())},N=[{path:"/",name:"home",component:()=>_(()=>import("./home.page.fb38b5bc.js"),["assets/home.page.fb38b5bc.js","assets/home.page.2d7a75e9.css","assets/vendor.51d93dd3.js","assets/plugin-vue_export-helper.21dcd24c.js"])},{path:"/edit/:iid",name:"editor",component:()=>_(()=>import("./editor.page.1f62ffef.js").then(function(e){return e.e}),["assets/editor.page.1f62ffef.js","assets/editor.page.78c27c23.css","assets/plugin-vue_export-helper.21dcd24c.js","assets/vendor.51d93dd3.js"])}],j=W({history:P(),routes:N});class J{constructor(){f(this,"baseUrl","/mocked-api")}getJson(t){return fetch(`${this.baseUrl}/${t}`).then(r=>r.json())}}const g=new J,T=new G({state:{categories:[],templateRecord:{},materialRecord:{},lastSaved:null,editingUnitId:1,editingDesign:null,editingData:null},actions:{async loadCategoriesAndTemplates({state:e}){await(e.categories.length?Promise.resolve():g.getJson("categories.json").then(o=>(e.categories=o,Promise.all(e.categories.map(async n=>{const i=await g.getJson(`templates/${n.slug}.json`);return{categoryId:n.id,templates:i}})))).then(o=>(e.templateRecord=o.reduce((n,i)=>(n[i.categoryId]=i.templates,n),{}),Promise.resolve())));const{categories:t,templateRecord:r}=e;return{categories:t,templateRecord:r}},async loadMaterials({state:e},t){return await(e.materialRecord[t.id]?Promise.resolve():g.getJson("materials/all.json").then(r=>(e.materialRecord[t.id]=r,Promise.resolve()))),e.materialRecord[t.id]},async resetEditing({state:e}){e.editingDesign=null,e.editingData=null},async loadEditing({state:e,dispatch:t},r){await(e.editingDesign&&e.editingDesign.id===r?Promise.resolve():new Promise((a,b)=>{const u=localStorage.getItem(`design_${r}`);if(!u)return b();e.editingDesign=JSON.parse(u),a(e.editingDesign)})),await(e.categories.length?Promise.resolve():t("loadCategoriesAndTemplates"));const o=e.categories.find(a=>a.id===e.editingDesign.category_id),n=e.templateRecord[o.id].find(a=>a.id===e.editingDesign.template_id);await(e.materialRecord[n.id]?Promise.resolve():t("loadMaterials",n));const i=e.materialRecord[n.id].find(a=>a.id===e.editingDesign.material_id);e.editingData={category:o,template:n,material:i};const{editingDesign:s,editingData:c}=e;return{editingDesign:s,editingData:c}},createDesign({state:e},t){return localStorage.setItem(`design_${t.id}`,JSON.stringify(t)),e.editingDesign=t,new Promise(r=>setTimeout(()=>r(t),300))},updateDesign({state:e},{side:t,data:r}){const o=e.editingUnitId,n=e.editingDesign;return n.design_data[o][t]=d(d({},n.design_data[o][t]),r),localStorage.setItem(`design_${n.id}`,JSON.stringify(n)),e.editingDesign=n},updateUnitId({state:e},t){return e.editingUnitId=t},updateLastSaved({state:e}){return e.lastSaved=new Date}}});$(k).use(j).use(T).mount("#app");export{j as r,T as s};
