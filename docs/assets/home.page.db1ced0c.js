var x=Object.defineProperty,m=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var ss=Object.prototype.hasOwnProperty,os=Object.prototype.propertyIsEnumerable;var E=(n,a,c)=>a in n?x(n,a,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[a]=c,L=(n,a)=>{for(var c in a||(a={}))ss.call(a,c)&&E(n,c,a[c]);if(q)for(var c of q(a))os.call(a,c)&&E(n,c,a[c]);return n},U=(n,a)=>m(n,I(a));import{d as es,g as C,h as j,o as l,c as t,i as s,F as k,j as S,u as B,p as ls,k as ts,t as h,n as D,l as O,w as g,m as w,q as as}from"./vendor.10c8995a.js";import{s as y,r as is}from"./index.e5aa3a5c.js";import{_ as ns}from"./plugin-vue_export-helper.21dcd24c.js";const N=n=>(ls("data-v-87887f8a"),n=n(),ts(),n),cs=N(()=>s("div",{class:"header"},[s("h1",null,"BOX-R")],-1)),ds={class:"main"},rs={class:"category-list"},us={class:"category-head"},_s=["src","alt"],vs={class:"template-list"},hs=["onClick"],fs={class:"info"},ps={class:"thumbnail"},ks=["src","alt"],gs={class:"content"},ys=as("Size: "),bs={class:"price"},Cs={key:0},Ss=N(()=>s("em",null,"\u20AB",-1)),Os={key:0,class:"detail"},ws={class:"links"},Ns={key:0,class:"start-from-scratch"},$s={class:"selectors"},Ts={class:"material-selection"},js=N(()=>s("h5",null,"Select material",-1)),Bs={class:"material-list"},Ds=["onClick"],Ms={class:"thumbnail"},zs={class:"content"},Rs={key:0,class:"price"},Fs={class:"color-selection"},Js=N(()=>s("h5",null,"Select color",-1)),Vs={key:0,class:"material-name"},As={class:"color-list"},qs=["onClick"],Es={key:1,class:"no-color"},Ls={class:"actions"},Us={key:1,class:"choose-a-design"},Xs=N(()=>s("p",null,"TODO: ...",-1)),Gs=[Xs],Hs=es({setup(n){const a=C("blank"),c=C(null),p=C(null),u=C(null),i=C(null),X=j(()=>y.state.categories),M=j(()=>y.state.materialRecord),G=j(()=>y.state.templateRecord);function H(r){is.push({name:"editor",params:{iid:`${r.slug}-${r.id}`}})}function K(){var e;if(!c.value||!p.value||!u.value||!((e=i.value)==null?void 0:e.front))return;const r={id:Math.floor(Math.random()*1e3),slug:"untitled-design",title:"Untitled design",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),template_id:p.value.id,category_id:c.value.id,material_id:u.value.id,design_data:{front:{showBackdrop:!0,showNumbering:!0,color:i.value.front,canvasJSON:JSON.stringify({version:"4.6.0",objects:[]})},back:{showBackdrop:!0,showNumbering:!0,color:i.value.back||i.value.front,canvasJSON:JSON.stringify({version:"4.6.0",objects:[]})}}};y.dispatch("createDesign",r).then(()=>H(r))}async function P(r,e){c.value=r,p.value=e,await y.dispatch("loadMaterials",e),z(M.value[e.id].find(_=>_.id===e.default_material_id))}function z(r){i.value=null,u.value=r,i.value=Object.keys(u.value.textures).reduce((e,_)=>(e[_]=u.value.textures[_].colors[0],e),{})}function Q(r,e){i.value=U(L({},i.value),{[r]:e})}function W(){alert("TODO: choose custom color ...")}return y.dispatch("loadCategoriesAndTemplates"),(r,e)=>(l(),t(k,null,[cs,s("div",ds,[s("ul",rs,[(l(!0),t(k,null,S(B(X),(_,Y)=>(l(),t("li",{key:Y},[s("h2",us,[s("img",{src:_.thumbnail,alt:_.title},null,8,_s),s("strong",null,h(_.title),1)]),s("ul",vs,[(l(!0),t(k,null,S(B(G)[_.id],(d,Z)=>{var R,F;return l(),t("li",{key:Z,onClick:o=>{var v;return d.id===((v=p.value)==null?void 0:v.id)?!1:P(_,d)},class:D({active:d.id===((R=p.value)==null?void 0:R.id)})},[s("div",fs,[s("div",ps,[s("img",{src:d.thumbnail,alt:d.title},null,8,ks)]),s("div",gs,[s("h3",null,h(d.title),1),s("p",null,[ys,s("strong",null,h(d.display_size),1)])]),s("div",bs,[d.sale_off?(l(),t("span",Cs,"-"+h(d.sale_off)+" off",1)):O("",!0),s("strong",null,h(d.base_price-d.sale_off),1),Ss])]),d.id===((F=p.value)==null?void 0:F.id)?(l(),t("div",Os,[s("div",ws,[s("h4",{onClick:e[0]||(e[0]=g(o=>a.value="blank",["prevent"])),style:w({opacity:a.value==="blank"?1:.5})},"Start from scratch",4),s("h4",{onClick:e[1]||(e[1]=g(o=>a.value="ready",["prevent"])),style:w({opacity:a.value==="ready"?1:.5})},"Choose a design",4)]),a.value==="blank"?(l(),t("div",Ns,[s("div",$s,[s("div",Ts,[js,s("ul",Bs,[(l(!0),t(k,null,S(B(M)[d.id],(o,v)=>{var f,$,b,T,J,V,A;return l(),t("li",{key:v,class:D({active:((f=u.value)==null?void 0:f.id)===o.id}),onClick:g(Ks=>z(o),["stop"])},[s("div",Ms,[s("em",{class:"color-front",style:w({background:(($=u.value)==null?void 0:$.id)===o.id&&((b=i.value)==null?void 0:b.front)?i.value.front:o.textures.front.colors[0]})},null,4),s("em",{class:"color-back",style:w({background:((T=u.value)==null?void 0:T.id)===o.id&&(((J=i.value)==null?void 0:J.back)||((V=i.value)==null?void 0:V.front))?i.value.back||i.value.front:((A=o.textures.back)==null?void 0:A.colors[0])||o.textures.front.colors[0]})},null,4)]),s("div",zs,[s("h6",null,h(o.title),1)]),o.offset_price?(l(),t("div",Rs,"+"+h(o.offset_price),1)):O("",!0)],10,Ds)}),128))])]),s("div",Fs,[Js,u.value&&u.value.textures.front.colors.length>1?(l(!0),t(k,{key:0},S(u.value.textures,(o,v)=>(l(),t("div",{key:v},[(o==null?void 0:o.title)?(l(),t("div",Vs,h(o.title),1)):O("",!0),s("ul",As,[(l(!0),t(k,null,S(o==null?void 0:o.colors,(f,$)=>{var b;return l(),t("li",{key:$,class:D({active:((b=i.value)==null?void 0:b[v])===f}),onClick:g(T=>Q(v,f),["stop"])},[s("h6",{class:"thumbnail",style:w({background:f})},null,4)],10,qs)}),128)),(o==null?void 0:o.customizable)?(l(),t("li",{key:0,class:"choose-custom",onClick:e[2]||(e[2]=g(f=>W(),["stop"]))},"(+)")):O("",!0)])]))),128)):(l(),t("p",Es,"This material doesn't support custom background color!"))])]),s("div",Ls,[s("button",{onClick:e[3]||(e[3]=g(o=>K(),["stop"]))},"Start editing")])])):(l(),t("div",Us,Gs))])):O("",!0)],10,hs)}),128))])]))),128))])])],64))}});var Zs=ns(Hs,[["__scopeId","data-v-87887f8a"]]);export{Zs as default};
